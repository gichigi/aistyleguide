---
description: 
globs: 
alwaysApply: false
---
# AI Style Guide Generator - Project Scratchpad

## 📋 Project Overview
Web app that generates brand style guides from website URLs using AI to extract and analyze brand elements. Built with Next.js, TypeScript, Tailwind CSS, OpenAI API, and Stripe.

## 🎯 Core User Journey
1. **Landing Page** → Enter website URL or create manually
2. **Website Analysis** → AI extracts brand info and autofills form
3. **Brand Details** → User reviews/edits brand information  
4. **Preview** → Shows partial style guide with paywall
5. **Payment** → Stripe checkout for full access
6. **Email Capture** → Collects email for thank you & abandoned cart recovery
7. **Full Access** → Complete style guide with download options

## ✅ Fully Completed & Deployed

### Core Application Infrastructure
- ✅ **Complete user journey** - Landing page → Brand details → Preview → Payment → Full access
- ✅ **AI website analysis** - Extracts brand info, autofills forms, handles multiple content types
- ✅ **Brand details form** - Real-time validation, character limits, comprehensive error handling
- ✅ **Template processing system** - Advanced markdown processing, validation, variable replacement
- ✅ **AI content generation** - OpenAI integration for voice traits, style rules, complete guides

### Payment & Email Systems
- ✅ **Stripe integration** - Complete checkout flow, webhook handling, test/live mode switching
- ✅ **Email automation** - Resend integration, thank you emails, abandoned cart recovery
- ✅ **Webhook processing** - Handles payment success, session expiration, discount codes
- ✅ **Email templates** - Professional HTML+text versions with branding

### Mobile & UI Experience
- ✅ **Mobile responsiveness** - Comprehensive responsive design across all pages
- ✅ **Mobile-optimized components** - Buttons, dialogs, navigation, form inputs
- ✅ **Loading states & animations** - Professional feedback throughout user journey
- ✅ **Preview system with paywall** - Fade-out effect, professional payment dialog

### Technical Foundation
- ✅ **Type safety** - Comprehensive TypeScript implementation with proper error handling
- ✅ **Security measures** - Input validation, timeout handling, no test endpoints in production
- ✅ **Performance optimizations** - Parallel API calls, appropriate model selection, caching
- ✅ **Template validation** - Content structure validation, markdown formatting, error recovery

### Download & Export
- ✅ **Multi-format downloads** - PDF, DOCX, HTML generation with consistent styling
- ✅ **File generation system** - Professional formatting, brand-consistent layouts

## 🔧 Setup & Configuration Needed

### High Priority (P0) - Blocking Production
- � **Email service configuration**:
  - Need: Real Resend API key (currently using placeholder)
  - Need: Domain verification for aistyleguide.com
  - Status: Code ready, just needs API key and DNS setup

### Medium Priority (P1) - Production Improvements  
- 🔧 **Analytics & monitoring** - Add production error tracking and user behavior analytics
- 🔧 **Performance monitoring** - Set up logging for API response times and error rates

## � Minor Optimizations & Polish

### Mobile Conversion (P2)
- 🔄 **Paywall positioning** - Reduce fade-out height on mobile to reach CTA faster
- 🔄 **Button accessibility** - Ensure all CTA buttons meet minimum touch target size

### UI Polish (P2)
- 🔄 **Loading states** - Replace preview loading interstitial with inline button states
- 🔄 **Error messaging** - Improve error message copy and retry options

### Content Validation (P2)
- 🔄 **Rule display validation** - Verify all 25 core rules and 99+ complete rules render correctly
- 🔄 **Template consistency** - Ensure core_template.md remains single source of truth

## 📚 Key Technical Notes

### Architecture Overview
- **Frontend**: Next.js 14, TypeScript, Tailwind CSS, Styled Components
- **Package Manager**: pnpm (always use instead of npm)
- **Backend**: Next.js API routes, OpenAI API, Stripe webhooks
- **Email**: Resend service with HTML+text templates
- **Storage**: localStorage for brand details, sessionStorage for temporary data

### Mobile Implementation Status
- **Responsive Design**: ✅ Fully implemented with sm:, md:, lg:, xl: breakpoints
- **Mobile-Specific CSS**: ✅ Comprehensive mobile optimizations in globals.css
- **Touch Targets**: ✅ All buttons meet accessibility standards
- **Mobile Dialogs**: ✅ Responsive payment dialogs with stacked layouts

### Email System Status
- **Service Integration**: ✅ Resend fully integrated with error handling
- **Template System**: ✅ Both thank you and abandoned cart emails implemented
- **Webhook Processing**: ✅ Complete event handling for success/expiration
- **Missing**: Real API key and domain verification only

### Payment Flow Status
- **Stripe Integration**: ✅ Complete with test/live mode support
- **Checkout Process**: ✅ Both core ($99) and complete ($149) options
- **Success Handling**: ✅ Proper redirects and access granting
- **Error Handling**: ✅ Comprehensive error states and retry logic

### Template Processing Status
- **Template Loading**: ✅ Dynamic template loading via API
- **Content Generation**: ✅ AI-powered content with validation
- **Markdown Processing**: ✅ Advanced formatting and structure validation
- **Variable Replacement**: ✅ Brand-specific content insertion

## 🗺️ Future Roadmap

### Short Term (Next 2 weeks)
- **Production deployment** - Set up email service and deploy to production
- **Analytics integration** - Add user behavior tracking and conversion metrics
- **Minor optimizations** - Address mobile conversion and UI polish items

### Medium Term (1-2 months)  
- **Advanced customization** - Allow users to modify generated content
- **Template variety** - Additional style guide formats and industry-specific templates
- **User dashboard** - Manage multiple purchased guides

### Long Term (3+ months)
- **Team collaboration** - Share guides within organizations
- **API for developers** - Programmatic access to style guide generation
- **White-label solution** - Agency reseller program

## � Development Notes

### Environment Variables Required
```
RESEND_API_KEY=your_real_api_key_here
STRIPE_MODE=test (or live for production)
STRIPE_TEST_SECRET_KEY=sk_test_...
STRIPE_SECRET_KEY=sk_live_...
STRIPE_TEST_WEBHOOK_SECRET=whsec_...
STRIPE_WEBHOOK_SECRET=whsec_...
NEXT_PUBLIC_APP_URL=https://aistyleguide.com
```

### Key Implementation Files
- `app/page.tsx` - Landing page with URL analysis (876 lines)
- `app/preview/page.tsx` - Preview with paywall (472 lines)
- `app/api/webhook/route.ts` - Email automation (237 lines)
- `lib/template-processor.ts` - Content generation (590 lines)
- `lib/email-service.ts` - Email templates (326 lines)

### Mobile CSS Classes Used
- Responsive breakpoints: `sm:`, `md:`, `lg:`, `xl:`
- Mobile-specific utilities: `.mobile-button`, `.mobile-dropdown`
- Touch-friendly sizing: `.mobile-action-button`
- Dialog adaptations: `.dialog-footer-mobile`

---

*Last updated: January 2025*
*Status: Production Ready - Needs Email Configuration Only*